<div id="listing-page" class="carousel slide" data-ride="carousel">
  <!-- Indicators -->
  <ol class="carousel-indicators">
    <li data-target="#listing-page" data-slide-to="0" class="active"></li>
    <li data-target="#listing-page" data-slide-to="1"></li>
    <li data-target="#listing-page" data-slide-to="2"></li>
  </ol>

  <!-- Wrapper for slides -->
  <div class="carousel-inner" role="listbox">
    <div class="item active">
      <% if @listing.read_attribute(:main_image).nil? %>
        <%= cl_image_tag ("no-image-found.jpg"), :width=>1500, :height=>700, :crop=>:scale %>
        <div class="carousel-caption">
          <%= link_to "Upload Here", edit_listing_path(@listing), :class=>"btn btn-primary btn-lg" %>
        </div>
      <% else %>
        <%= cl_image_tag @listing.main_image, :width=>1500, :height=>700, :crop=>:scale %>
      <% end %>
    </div>
    <div class="item">
      <% if @listing.read_attribute(:sub_image_one).nil? %>
        <%= cl_image_tag ("no-image-found.jpg"), :width=>1500, :height=>700, :crop=>:scale %>
        <div class="carousel-caption">
          <%= link_to "Upload Here", edit_listing_path(@listing), :class=>"btn btn-primary btn-lg" %>
        </div>
      <% else %>
        <%= cl_image_tag @listing.sub_image_one, :width=>1500, :height=>700, :crop=>:scale %>
      <% end %>
    </div>
    <div class="item">
     <% if @listing.read_attribute(:sub_image_two).nil? %>
        <%= cl_image_tag ("no-image-found.jpg"), :width=>1500, :height=>700, :crop=>:scale %>
        <div class="carousel-caption">
          <%= link_to "Upload Here", edit_listing_path(@listing), :class=>"btn btn-primary btn-lg" %>
        </div>
      <% else %>
        <%= cl_image_tag @listing.sub_image_two, :width=>1500, :height=>700, :crop=>:scale %>
      <% end %>
    </div>
  </div>

  <!-- Controls -->
  <a class="left carousel-control" href="#listing-page" role="button" data-slide="prev">
    <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
    <span class="sr-only">Previous</span>
  </a>
  <a class="right carousel-control" href="#listing-page" role="button" data-slide="next">
    <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
    <span class="sr-only">Next</span>
  </a>
</div>

<h1>
	<strong>Title: </strong><%= @listing.title %> by <em><%= @listing.user.name %></em>
</h1>

<p>
	<strong>Home Type: </strong><%= @listing.home_type %>
</p>

<p>
	<strong>Room Type: </strong><%= @listing.room_type %>
</p>

<p>
	<strong>Accomodate: </strong><%= @listing.accomodate %>
</p>

<p>
	<strong>Location: </strong><%= @listing.location %>
</p>

<p>
  <strong>City, State: </strong><%= @listing.city_state %>
</p>

<p>
  <strong>Country: </strong><%= @listing.country %>
</p>

<p>
<%= image_tag "http://maps.google.com/maps/api/staticmap?size=450x300&sensor=false&zoom=16&markers=#{@listing.latitude}%2C#{@listing.longitude}" %>
</p>

<h3>Nearby locations</h3>
<ul>
<% for location in @listing.nearbys(100) %>
  <li><%= link_to location.title, location %> (<%= location.distance.round(2) %> miles)</li>
<% end %>
</ul>

<p>
	<strong>Price Per Night: </strong><%= @listing.price %>
</p>
<p>
	<strong>Description: </strong><%= @listing.description %>
</p>

<div id= "box"></div>

<p>
	<%= link_to "Booking", new_listing_reservation_path(@listing), id: "new_booking", remote: true %>
</p>

<h2>Comment: </h2>

<p>
	<%= render @listing.comments %>
</p>

<% if !current_user.nil? %>
	<h2>Add a comment:</h2>
	
	<p>
		<%= render 'comments/form' %>
	</p>
<% else %>
<p>
	<strong>You must <%= link_to "sign in", new_user_session_path %> to write a comment</strong>
</p>
<% end %>

<p>
	<%= link_to "Edit Listing", edit_listing_path(@listing) %> |

	<%= link_to "Delete Listing", listing_path(@listing), method: :delete, data: { confirm: "Are you sure you want to delete '#{@listing.title}'?"} %>
</p>

<%= link_to "Back", listings_path %>